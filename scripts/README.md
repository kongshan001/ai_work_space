# GitHub Trends 报告自动化脚本

## 📋 概述

本目录包含自动生成 GitHub 趋势报告的脚本和定时任务配置。

### 脚本列表

- `generate-daily-trends.sh` - 每日趋势报告生成器
- `generate-weekly-trends.sh` - 每周趋势报告生成器
- `README.md` - 本说明文档

## ⏰ 定时任务配置

### Crontab 配置

```bash
crontab -l
```

**当前配置：**

```cron
# GitHub Trends Reports - Generated by OpenClaw AI Agent
# Daily report at 18:00 (GMT+8)
0 18 * * * /root/.openclaw/workspace/scripts/generate-daily-trends.sh >> /root/.openclaw/workspace/logs/cron-daily.log 2>&1

# Weekly report at 20:00 on Sunday (GMT+8)
0 20 * * 0 /root/.openclaw/workspace/scripts/generate-weekly-trends.sh >> /root/.openclaw/workspace/logs/cron-weekly.log 2>&1
```

### 执行时间

- **每日报告**：每天 18:00 (GMT+8)
- **每周报告**：每周日 20:00 (GMT+8)

## 🔧 手动执行

### 生成每日报告

```bash
bash /root/.openclaw/workspace/scripts/generate-daily-trends.sh
```

### 生成每周报告

```bash
bash /root/.openclaw/workspace/scripts/generate-weekly-trends.sh
```

## 📊 报告输出位置

### 每日报告
- 目录：`/root/.openclaw/workspace/reports/github-trends/daily/`
- 命名：`github-trends-daily-YYYY-MM-DD.md`
- 示例：`github-trends-daily-2026-02-14.md`

### 每周报告
- 目录：`/root/.openclaw/workspace/reports/github-trends/weekly/`
- 命名：`github-trends-weekly-YYYY-Www.md`
- 示例：`github-trends-weekly-2026-W07.md`

## 🔐 GitHub API Token 配置

### 为什么需要 Token？

当前脚本使用网页抓取方式获取数据，只能生成报告框架。如需自动获取实时数据，需要配置 GitHub Personal Access Token。

### 获取 Token 步骤

1. **登录 GitHub** → 进入 **Settings**（设置）
2. **Developer settings** → **Personal access tokens** → **Tokens (classic)**
3. **Generate new token** → **Generate new token (classic)**
4. **配置权限**：
   - ✅ `public_repo` - 访问公开仓库
   - ✅ `read:user` - 读取用户信息
   - ✅ `read:org`（可选）- 读取组织信息
5. **生成 Token**（只显示一次，立即复制）

### 配置 Token

创建文件 `~/.github_token`：

```bash
echo "your_github_token_here" > ~/.github_token
chmod 600 ~/.github_token
```

然后修改脚本，在数据获取部分使用 API 调用：

```bash
GITHUB_TOKEN=$(cat ~/.github_token)

# 使用 GitHub API 获取 trending 数据
curl -H "Authorization: token $GITHUB_TOKEN" \
     https://api.github.com/search/repositories?q=created:>2024-01-01&sort=stars&order=desc&per_page=20
```

## 📝 日志文件

### 日志位置

- 每日报告日志：`/root/.openclaw/workspace/logs/cron-daily.log`
- 每周报告日志：`/root/.openclaw/workspace/logs/cron-weekly.log`

### 查看日志

```bash
# 查看每日报告日志
tail -f /root/.openclaw/workspace/logs/cron-daily.log

# 查看每周报告日志
tail -f /root/.openclaw/workspace/logs/cron-weekly.log
```

## 🛠️ 故障排除

### 问题：脚本未执行

**检查步骤：**

1. 检查 cron 服务是否运行：
   ```bash
   systemctl status cron
   ```

2. 检查 crontab 是否安装：
   ```bash
   crontab -l
   ```

3. 检查脚本权限：
   ```bash
   ls -la /root/.openclaw/workspace/scripts/*.sh
   ```

4. 查看系统日志：
   ```bash
   tail -f /var/log/syslog | grep CRON
   ```

### 问题：报告未提交到 GitHub

**检查步骤：**

1. 检查 Git 凭证配置：
   ```bash
   cat ~/.git-credentials
   ```

2. 手动测试推送：
   ```bash
   cd /root/.openclaw/workspace
   git push origin master
   ```

3. 查看 Git 日志：
   ```bash
   cat /root/.openclaw/workspace/logs/cron-daily.log
   ```

### 问题：数据为空

**可能原因：**

1. 未配置 GitHub API Token → 脚本只生成框架
2. Token 权限不足 → 检查 token 是否包含必要权限
3. API 限流 → 等待一段时间后重试

## 🔄 更新脚本

### 修改定时时间

编辑 crontab：
```bash
crontab -e
```

### 禁用定时任务

临时禁用（注释掉）：
```bash
crontab -e
# 在任务前添加 #
```

永久删除：
```bash
crontab -r
```

## 📈 增强功能建议

### 未来可以添加的功能

1. **多语言支持**：生成中英文双语报告
2. **邮件通知**：报告生成后发送邮件通知
3. **Slack 集成**：自动发布到 Slack 频道
4. **数据分析**：添加统计图表和趋势分析
5. **项目追踪**：持续追踪特定项目的变化

## 📞 支持

如有问题，请检查：

1. 脚本日志文件
2. Git 推送日志
3. 系统 cron 日志

---

**最后更新**：2026-02-14
**维护者**：OpenClaw AI Agent
